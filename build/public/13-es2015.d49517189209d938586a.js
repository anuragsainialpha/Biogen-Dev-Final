(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{GTCo:function(e,t,i){"use strict";i.r(t),i.d(t,"ShipmentModule",(function(){return I}));var s=i("mrSG"),r=i("5+WD"),n=i("fXoL"),a=i("lKJ0");let c=(()=>{class e{constructor(e){this.transmissionService=e,this.currentInstanceOf="ShipmentService",this.dragdropList=[],this.dragdropListTc=[],this.ElementList=[],this.releasedragdropList=[],this.releaseElementList=[],this.linedragdropList=[],this.lineElementList=[],this.csvHeader=[],this.csvHeaderAll=[],this.csvRow=[],this.csvRowAll=[],this.xmlArray=[],this.loader={i:!1,d:!1},this.errors={csv:[],server:""},this.uploadProgress=0,this.statusRequest={transmission:[],reProcess:!0,xids:[]},this.showStatus=!1,this.statusCount={p:0,e:0,s:0,f:0},this.getViewUrl=(e,t,i)=>{if("P"!==i)return"";const s=this.csvHeader.findIndex(e=>e===this.dragdropListTc[this.itemIdIndex].displayText),r=this.csvHeader.findIndex(e=>e===this.dragdropListTc[this.itemIdDomain].displayText);return-1===s?"":e.replace("GTM_OTM_OBJECT","Shipment").replace("GTM_OTM_MANAGER_LAYOUT_GID","SHIPMENT_VIEW").replace("GTM_OTM_FINDER_SET","BUY_SHIPMENT").replace("GTM_OTM_OBJECT_GID",`${this.csvRow[t][r]||this.transmissionService.userDetails.domain}.${this.csvRow[t][s].toUpperCase()}`)}}linedrop(e){Object(r.d)(this.linedragdropList,e.previousIndex,e.currentIndex),this.dragdropList=[...this.releasedragdropList,...this.linedragdropList]}releasedrop(e){Object(r.d)(this.releasedragdropList,e.previousIndex,e.currentIndex),this.dragdropList=[...this.releasedragdropList,...this.linedragdropList]}releaseValueChange(e){return Object(s.a)(this,void 0,void 0,(function*(){return this.releasedragdropList=e.required?this.releaseElementList.filter(e=>!0===e.required):this.releasedragdropList.filter(t=>t.name!==e.name),this.dragdropList=[...this.releasedragdropList,...this.linedragdropList],yield this.transmissionService.updateShipment(e)}))}lineValueChange(e){return Object(s.a)(this,void 0,void 0,(function*(){return this.linedragdropList=e.required?this.lineElementList.filter(e=>!0===e.required):this.linedragdropList.filter(t=>t.name!==e.name),this.dragdropList=[...this.releasedragdropList,...this.linedragdropList],yield this.transmissionService.updateShipment(e)}))}onUpload(e){return Object(s.a)(this,void 0,void 0,(function*(){this.itemIdIndex=this.dragdropListTc.findIndex(e=>e.path[0].includes("ShipmentGid")&&e.path[0].includes("Xid")),this.itemIdDomain=this.dragdropListTc.findIndex(e=>e.path[0].includes("ShipmentGid")&&e.path[0].includes("DomainName"));const t={dragdropList:this.dragdropListTc,containLines:!0,parentGidIdentifierPathString:"ShipmentGid",lineIdentifierPathString:"ShipmentStop"};yield this.transmissionService.onUpload(e,t,this)}))}onRefreshStatus(){return Object(s.a)(this,void 0,void 0,(function*(){yield this.transmissionService.onRefreshStatus(this)}))}sendDataToGtm(){return Object(s.a)(this,void 0,void 0,(function*(){yield this.transmissionService.sendDataToGtm(this,"ShipmentGid")}))}getInitialState(e){e.table&&(this.csvHeader.length=0,this.csvRow.length=0,this.showStatus=!1,this.statusCount={p:0,e:0,s:0,f:0}),this.xmlArray.length=0,this.uploadProgress=0,this.errors.csv.length=0,this.errors.server=""}}return e.\u0275fac=function(t){return new(t||e)(n.gc(a.a))},e.\u0275prov=n.Sb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var d=i("tyNb"),o=i("ofXK"),l=i("wZkO"),h=i("CW4N"),p=i("bv9b");const m=["fileInput"];function v(e,t){if(1&e&&(n.ac(0),n.cc(1,"h2",8),n.Mc(2),n.bc(),n.Xb(3,"mat-progress-bar",9),n.Zb()),2&e){const e=n.oc(3);n.Jb(2),n.Oc("",e.itemService.uploadProgress," %"),n.Jb(1),n.vc("color",e.transmissionService.getInstanceColor())("bufferValue",e.itemService.uploadProgress+20)("value",e.itemService.uploadProgress)}}function u(e,t){1&e&&(n.cc(0,"div",6),n.cc(1,"div",10),n.Mc(2,"Loading"),n.bc(),n.bc())}function g(e,t){if(1&e&&(n.cc(0,"div"),n.cc(1,"div",6),n.Lc(2,v,4,4,"ng-container",0),n.Lc(3,u,3,0,"div",7),n.bc(),n.bc()),2&e){const e=n.oc(2);n.Jb(2),n.vc("ngIf",e.itemService.loader.d),n.Jb(1),n.vc("ngIf",e.itemService.loader.i)}}function b(e,t){if(1&e&&(n.ac(0),n.cc(1,"mat-tab-group",2),n.cc(2,"mat-tab",3),n.Xb(3,"app-shared-tab",4),n.bc(),n.cc(4,"mat-tab",5),n.Xb(5,"app-shared-tab",4),n.bc(),n.bc(),n.Lc(6,g,4,2,"div",0),n.Zb()),2&e){const e=n.oc();n.Jb(1),n.vc("color",e.transmissionService.getInstanceColor()),n.Jb(2),n.vc("hasChild",!0)("tabTitle","Shipment")("tabTitleExtension","Stop")("itemService",e.itemService)("isAdminTab",!1),n.Jb(2),n.vc("hasChild",!0)("tabTitle","Shipment")("tabTitleExtension","Stop")("itemService",e.itemService)("isAdminTab",!0),n.Jb(1),n.vc("ngIf",e.itemService.loader.i||e.itemService.loader.d)}}function f(e,t){if(1&e&&(n.cc(0,"div",11),n.cc(1,"span",12),n.Mc(2,"\xd7"),n.bc(),n.cc(3,"div",13),n.Mc(4),n.bc(),n.bc()),2&e){const e=n.oc();n.Jb(4),n.Oc(" ",e.error," ")}}let S=(()=>{class e{constructor(e,t,i){this.itemService=e,this.transmissionService=t,this.activatedRoute=i,this.isAdminTab=!1}ngOnInit(){return Object(s.a)(this,void 0,void 0,(function*(){const{data:e,error:t}=this.activatedRoute.snapshot.data.data;if(t)return this.error=t;this.itemService.ElementList=e.filter(e=>this.getElement(e)),this.transmissionService.displayShipment=e,this.itemService.dragdropList=this.itemService.ElementList.filter(e=>e.required),this.itemService.dragdropListTc=e.filter(e=>e.required),this.itemService.releaseElementList=e.filter(e=>this.getReleaseElement(e)),this.itemService.lineElementList=e.filter(e=>this.getLineElement(e)),this.itemService.releasedragdropList=this.itemService.releaseElementList.filter(e=>e.display&&e.required),this.itemService.linedragdropList=this.itemService.lineElementList.filter(e=>e.display&&e.required)}))}getElement(e){return this.transmissionService.getElement(e)}getReleaseElement(e){return(e.path.length>1||!(!e.display||!this.transmissionService.getElement(e)))&&!e.type.includes("Stop")&&e.display}getLineElement(e){return(e.path.length>1||!(!e.display||!this.transmissionService.getElement(e)))&&e.display&&e.type.includes("Stop")}}return e.\u0275fac=function(t){return new(t||e)(n.Wb(c),n.Wb(a.a),n.Wb(d.a))},e.\u0275cmp=n.Qb({type:e,selectors:[["app-shipment"]],viewQuery:function(e,t){var i;1&e&&n.Sc(m,!0),2&e&&n.Cc(i=n.lc())&&(t.myInputVariable=i.first)},decls:2,vars:2,consts:[[4,"ngIf"],["class","alert danger",4,"ngIf"],["dynamicHeight","",3,"color"],["label","Download Template"],[3,"hasChild","tabTitle","tabTitleExtension","itemService","isAdminTab"],["label","Create Template"],[1,"ui","active","inverted","dimmer"],["class","ui active inverted dimmer",4,"ngIf"],[1,"example-h2"],["mode","buffer",2,"width","50%",3,"color","bufferValue","value"],[1,"ui","text","loader"],[1,"alert","danger"],["onclick","this.parentElement.style.display='none';",1,"closebtn"],[1,"alert-header"]],template:function(e,t){1&e&&(n.Lc(0,b,7,12,"ng-container",0),n.Lc(1,f,5,1,"div",1)),2&e&&(n.vc("ngIf",!t.error),n.Jb(1),n.vc("ngIf",t.error))},directives:[o.m,l.b,l.a,h.a,p.a],styles:[""]}),e})();var L=i("jvDc");const T=[{path:"",component:S}];let I=(()=>{class e{}return e.\u0275mod=n.Ub({type:e}),e.\u0275inj=n.Tb({factory:function(t){return new(t||e)},providers:[c],imports:[[d.i.forChild(T),L.a]]}),e})()}}]);