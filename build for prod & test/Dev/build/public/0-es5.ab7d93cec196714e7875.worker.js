!function(n){var t={};function r(e){if(t[e])return t[e].exports;var a=t[e]={i:e,l:!1,exports:{}};return n[e].call(a.exports,a,a.exports,r),a.l=!0,a.exports}r.m=n,r.c=t,r.d=function(n,t,e){r.o(n,t)||Object.defineProperty(n,t,{enumerable:!0,get:e})},r.r=function(n){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})},r.t=function(n,t){if(1&t&&(n=r(n)),8&t)return n;if(4&t&&"object"==typeof n&&n&&n.__esModule)return n;var e=Object.create(null);if(r.r(e),Object.defineProperty(e,"default",{enumerable:!0,value:n}),2&t&&"string"!=typeof n)for(var a in n)r.d(e,a,(function(t){return n[t]}).bind(null,a));return e},r.n=function(n){var t=n&&n.__esModule?function(){return n.default}:function(){return n};return r.d(t,"a",t),t},r.o=function(n,t){return Object.prototype.hasOwnProperty.call(n,t)},r.p="",r(r.s="riMl")}({riMl:function(n,t,r){"use strict";r.r(t);var e=["TransactionCode","DomainName"],a=["Item ID","Party ID","Location ID","Transaction ID","Line ID"];function o(n,t,r,e){var a=function(n,t){return new RegExp("\\b("+n+"|"+t+")(.*?)Xid\\b","g")}(r,e);for(var o in n)if(n.hasOwnProperty(o)){if(o.match(a))continue;if(n[o]!==t[o])return!!o.includes(e+".")}return!0}function i(n,t,r,e){var a={};for(var o in e)e.hasOwnProperty(o)&&(o.includes(n+".")?a[c(o,n,t)]=e[o]:a[o]=r[o]);return a}function c(n,t,r){return n.replace(t+".",t+"."+r+".")}function u(n,t,r,e,a,o,i,c){(function(n,t,r,e){return"Inco Term ID"===n[t]&&!p(r.transaction)&&!p(r.transaction.incoterm)&&!r.transaction.incoterm[e]})(n,t,r,e)||function(n,t,r,e){return"Line Inco Term ID"===n[t]&&!p(r.transaction)&&!p(r.transaction.incoterm)&&!r.transaction.incoterm[e]}(n,t,r,e)||function(n,t,r,e){return"Shipping Condition"===n[t]&&!p(r.transaction)&&!p(r.transaction.other)&&!r.transaction.other[e]}(n,t,r,e)||function(n,t,r,e){return"UOM"===n[t]&&!p(r.transaction)&&!p(r.transaction.quantity)&&!r.transaction.quantity[e]}(n,t,r,e)||function(n,t,r,e){return"Line Quantity UOM"===n[t]&&!p(r.transaction)&&!p(r.transaction.quantity)&&!r.transaction.quantity[e]}(n,t,r,e)||function(n,t,r,e){return"Global Currency Code"===n[t]&&!p(r.transaction)&&!p(r.transaction.currencyCode)&&!r.transaction.currencyCode[e]}(n,t,r,e)||function(n,t,r,e){return"Line Currency"===n[t]&&!p(r.transaction)&&!p(r.transaction.currencyCode)&&!r.transaction.currencyCode[e]}(n,t,r,e)||function(n,t,r,e){return String(n[t][0]).match(/GtmContact(.*?)LocationRef(.*?)CountryCode3Gid(.*?)Xid/)&&!p(r.party.country)&&!r.party.country[e]}(c,t,r,e)||function(n,t,r,e){return"Country Code 2"===n[t]&&!p(r.party)&&!p(r.party.country)&&!r.party.country[e]}(n,t,r,e)||function(n,t,r,e){return"Handling Instructions"===n[t]&&!p(r.transaction)&&!p(r.transaction.other)&&!r.transaction.other[e]}(n,t,r,e)?a.error.push(l(e,n,t,o)):i[c[t]]=e}function s(n,t,r,e,a,o,i,c){n[t].forEach((function(n,u){""===n.value?function(n,t,r,e,a,o,i,c){String(n[t]).includes("YYYY-MM-DD")&&!d(r)&&e.error.push(l(r,n,t,a)),String(n[t]).includes("YYYY-MM-DD")&&d(r)?o[i.path]=r.replace(/-/gi,"").concat("080000"):function(n,t,r,e){return function(n,t,r,e){return function(n,t){return n[t].match(/[HTS|ECCN] [A-Z][A-Z]/)||"SCHEDULE B"===n[t]}(n,t)&&!r.item.codes[n[t]+" - "+e]}(n,t,r,e)&&!p(r.item.codes)}(n,t,c,r)||function(n,t,r,e){return"Country Of Origin"===n[t]&&!r.item.country[e]}(n,t,c,r)||function(n,t,r,e){return"Line Uom Net Weight"===n[t]&&!p(r.transaction)&&!p(r.transaction.quantity)&&!r.transaction.quantity[e]}(n,t,c,r)||function(n,t,r,e){return"Line Uom Gross Weight"===n[t]&&!p(r.transaction)&&!p(r.transaction.quantity)&&!r.transaction.quantity[e]}(n,t,c,r)||function(n,t,r,e){return"Line Uom Total Packaging Unit Count"===n[t]&&!p(r.transaction)&&!p(r.transaction.quantity)&&!r.transaction.quantity[e]}(n,t,c,r)?e.error.push(l(r,n,t,a)):function(n,t){return"Country Of Origin Substance"===n[t]}(n,t)?c.item.country[r]?o[i.path]=c.item.country[r]:e.error.push(l(r,n,t,a)):function(n,t,r,e){return!p(n.transaction)&&!p(n.transaction.other)&&n.transaction.other&&n.transaction.other[t[r]]&&!n.transaction.other[t[r]][e]}(c,n,t,r)||function(n,t){return n.path.match(/GtmTransactionLine(.*?)(Quantity|Currency)(.*?)(QuantityValue|MonetaryAmount)/)&&isNaN(t)}(i,r)||function(n,t,r){return n.path.match(/GtmTransactionLine(.*?)ItemGid(.*?)Xid/)&&!p(t.transaction)&&t.transaction.items&&!t.transaction.items[t.domain+"."+r]}(i,c,r)||function(n,t,r){return n.path.match(/GtmTransaction(.*?)ContactGid(.*?)Xid/)&&!p(t.transaction)&&t.transaction.contacts&&!t.transaction.contacts[t.domain+"."+r]}(i,c,r)?e.error.push(l(r,n,t,a)):o[i.path]=function(n,t,r,e){return"Country Of Origin"===n[t]&&r.item.country[e]}(n,t,c,r)?c.item.country[r]:r}(r,t,e,a,o,i,n,c):"PUBLIC"!==n.value&&(i[n.path]=n.value)}))}function f(n,t,r,e,o,i,c){var u=n.find((function(n){return n.path===t[r]}));if(u&&u.defaultValue)e[t[r]]=u.defaultValue;else if(u.disabled)if(u.disabled&&a.includes(u.name)){var s=function(n,t,r){return n.name.includes("Item")?r.item.str+""+String(r.item.counter+t).padStart(5,"0"):n.name.includes("Party")?r.contact.str+"-"+String(r.contact.counter+t).padStart(8,"0"):n.name.includes("Location")?r.location.str+"-"+String(r.location.counter+t).padStart(8,"0"):n.name.includes("Transaction ID")?r.transaction.str+"-"+String(r.transaction.counter+t).padStart(8,"0"):n.name.includes("Line ID")?r.transactionLine.str+"-"+String(r.transactionLine.counter+t).padStart(8,"0"):void 0}(u,i+1,c);t[r].forEach((function(n,t){""===n.value&&(e[n.path]=s)}))}else o.error.push("".concat(u.displayText," is missing at row  ").concat(i))}function l(n,t,r,e){return"".concat(n," value for ").concat(t[r]," is invalid at row  ").concat(e+1)}function d(n){if(!String(n).match(/^\d{4}-\d{2}-\d{2}$/))return!1;var t=new Date(n),r=t.getTime();return!(!r&&0!==r)&&t.toISOString().slice(0,10)===n}function p(n){for(var t in n)if(n.hasOwnProperty(t))return!1;return!0}addEventListener("message",(function(n){return r=regeneratorRuntime.mark((function t(){var r,a,c,l,d,p,v,m;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=n.data,a=r.fileData,c=r.dragdropList,l=r.containLines,d=r.parentGidIdentifierPathString,p=r.lineIdentifierPathString,v=r.validationData,console.log("worker input",n.data),m=function(n,t,r,a,c,l){var d=l.autoGen,p=[],v=n[0],m=function(n,t){return Array.from(new Set(n[0].concat(t.filter((function(n){return e.find((function(t){return n.name.includes(t)}))||n.disabled})).map((function(n){return n.displayText})))))}(n,t);console.log("dragdropList:",t);var y=n.slice(1,n.length),h={data:[],error:[],csvHeader:[],csvHeaderAll:[],csvRow:[],csvRowAll:[]};if(!y.length)return function(n,t){return n.error.push("csv must contain data"),n.csvHeader=t,n}(h,v);if(function(n,t,r,e){for(var a=function(a){var o=n[a],i=t.findIndex((function(n){return n.displayText===o}));i>-1?r.push(t[i].path):e.error.push("Column ".concat(o," not allowed"))},o=0;o<n.length;o++)a(o)}(m,t,p,h),h.error.length)return function(n,t,r){return n.csvHeader=t,n.csvRow=r,n}(h,v,y);var g=function(n,t,r,e,a,o,i){for(var c=[],l=0;l<n.length;l++){for(var d={},p=0;p<t.length;p++){var v=n[l][p];v&&r[p].length>1?s(r,p,t,v,e,l,d,o):v?u(t,p,o,v,e,l,d,r):f(a,r,p,d,e,l,i)}c.push(d)}return c}(y,m,p,h,t,l,d);return h.error.length?function(n,t,r){return n.csvHeader=t,n.csvRow=r,n}(h,v,y):(function(n,t,r,e,a,c,u){var s;(s=t).sort((function(n,t){return n-t})),console.log(s),s.forEach((function(n,t){n=String(n).slice(7)})),t=s,n&&t.length>1?function(n,t,r,e){for(var a=0,c=0;c<n.length;)o(n[a],n[c],t,r)?(e.data.push(i(r,a,n[a],n[c])),c++):(e.data.push(n[c]),a=c,c++)}(t,r,e,a):a.data=t,a.csvHeader=c,a.csvRow=u}(r,g,a,c,h,v,y),h.csvHeaderAll=g.map((function(n){return Object.keys(n)})),h.csvRowAll=g.map((function(n){return Object.values(n)})),h)}(a,c,l,d,p,v),console.log("csvDataToObject:",m),postMessage({result:m.data,error:m.error,csvHeader:m.csvHeader,csvHeaderAll:m.csvHeaderAll,csvRow:m.csvRow,csvRowAll:m.csvRowAll});case 4:case"end":return t.stop()}}),t)})),new((t=void 0)||(t=Promise))((function(n,e){function a(n){try{i(r.next(n))}catch(t){e(t)}}function o(n){try{i(r.throw(n))}catch(t){e(t)}}function i(r){var e;r.done?n(r.value):(e=r.value,e instanceof t?e:new t((function(n){n(e)}))).then(a,o)}i((r=r.apply(void 0,[])).next())}));var t,r}))}});