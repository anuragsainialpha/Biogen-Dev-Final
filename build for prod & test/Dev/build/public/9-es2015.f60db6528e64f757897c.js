(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{BR1Y:function(t,i,e){"use strict";e.r(i),e.d(i,"LocationModule",(function(){return L}));var s=e("mrSG"),r=e("5+WD"),n=e("fXoL"),o=e("lKJ0");let c=(()=>{class t{constructor(t){this.transmissionService=t,this.currentInstanceOf="LocationService",this.dragdropList=[],this.dragdropListTc=[],this.ElementList=[],this.csvHeader=[],this.csvHeaderAll=[],this.csvRow=[],this.csvRowAll=[],this.xmlArray=[],this.loader={i:!1,d:!1},this.errors={csv:[],server:""},this.uploadProgress=0,this.statusRequest={transmission:[],reProcess:!0,xids:[]},this.statusCount={p:0,e:0,s:0,f:0},this.showStatus=!1,this.xids=[],this.responseTransmissions=[],this.getViewUrl=(t,i,e)=>{if("P"!==e)return"";const s=this.csvHeader.findIndex(t=>t===this.dragdropListTc[this.itemIdIndex].displayText),r=this.csvHeader.findIndex(t=>t===this.dragdropListTc[this.itemIdDomain].displayText);return-1===s?"":t.replace("GTM_OTM_OBJECT","Location").replace("GTM_OTM_MANAGER_LAYOUT_GID","GTM_LOCATION_VIEW").replace("GTM_OTM_FINDER_SET","GTM_LOCATION").replace("GTM_OTM_OBJECT_GID",`${this.csvRow[i][r]||this.transmissionService.userDetails.domain}.${this.csvRow[i][s].toUpperCase()}`)}}drop(t){Object(r.d)(this.dragdropList,t.previousIndex,t.currentIndex)}valueChange(t){return Object(s.a)(this,void 0,void 0,(function*(){return this.dragdropList=t.required?this.ElementList.filter(t=>!0===t.required):this.dragdropList.filter(i=>i.name!==t.name),yield this.transmissionService.updateLocation(t)}))}onUpload(t){return Object(s.a)(this,void 0,void 0,(function*(){this.itemIdIndex=this.dragdropListTc.findIndex(t=>t.path[0].includes("LocationGid")&&t.path[0].includes("Xid")),this.itemIdDomain=this.dragdropListTc.findIndex(t=>t.path[0].includes("LocationGid")&&t.path[0].includes("DomainName"));const i={dragdropList:this.dragdropListTc,containLines:!1,parentGidIdentifierPathString:"",lineIdentifierPathString:""};yield this.transmissionService.onUpload(t,i,this)}))}onRefreshStatus(){return Object(s.a)(this,void 0,void 0,(function*(){yield this.transmissionService.onRefreshStatus(this)}))}sendDataToGtm(){return Object(s.a)(this,void 0,void 0,(function*(){yield this.transmissionService.sendDataToGtm(this,"LocationGid")}))}getInitialState(t){t.table&&(this.csvHeader.length=0,this.csvRow.length=0,this.showStatus=!1,this.statusCount={p:0,e:0,s:0,f:0}),this.xmlArray.length=0,this.uploadProgress=0,this.errors.csv.length=0,this.errors.server=""}}return t.\u0275fac=function(i){return new(i||t)(n.gc(o.a))},t.\u0275prov=n.Sb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var a=e("tyNb"),d=e("ofXK"),l=e("wZkO"),h=e("CW4N"),v=e("bv9b");const u=["fileInput"];function p(t,i){if(1&t&&(n.cc(0,"div",7),n.cc(1,"h2",8),n.Mc(2),n.bc(),n.Xb(3,"mat-progress-bar",9),n.bc()),2&t){const t=n.oc(2);n.Jb(2),n.Oc("",t.locationService.uploadProgress," %"),n.Jb(1),n.vc("color",t.transmissionService.getInstanceColor())("bufferValue",t.locationService.uploadProgress+20)("value",t.locationService.uploadProgress)}}function b(t,i){1&t&&(n.cc(0,"div",7),n.cc(1,"div",10),n.Mc(2,"Loading"),n.bc(),n.bc())}function m(t,i){if(1&t&&(n.ac(0),n.cc(1,"mat-tab-group",2),n.cc(2,"mat-tab",3),n.Xb(3,"app-shared-tab",4),n.bc(),n.cc(4,"mat-tab",5),n.Xb(5,"app-shared-tab",4),n.bc(),n.bc(),n.Lc(6,p,4,4,"div",6),n.Lc(7,b,3,0,"div",6),n.Zb()),2&t){const t=n.oc();n.Jb(1),n.vc("color",t.transmissionService.getInstanceColor()),n.Jb(2),n.vc("itemService",t.locationService)("tabTitle","Location")("isAdminTab",!1),n.Jb(2),n.vc("itemService",t.locationService)("tabTitle","Location")("isAdminTab",!0),n.Jb(1),n.vc("ngIf",t.locationService.loader.d),n.Jb(1),n.vc("ngIf",t.locationService.loader.i)}}function f(t,i){if(1&t&&(n.cc(0,"div",11),n.cc(1,"span",12),n.Mc(2,"\xd7"),n.bc(),n.cc(3,"div",13),n.Mc(4),n.bc(),n.bc()),2&t){const t=n.oc();n.Jb(4),n.Oc(" ",t.error," ")}}let g=(()=>{class t{constructor(t,i,e){this.locationService=t,this.transmissionService=i,this.activatedRoute=e,this.isAdminTab=!1}ngOnInit(){return Object(s.a)(this,void 0,void 0,(function*(){const{data:t,error:i}=this.activatedRoute.snapshot.data.data;if(i)return this.error=i;this.locationService.ElementList=t.filter(t=>this.getElement(t)),this.locationService.dragdropList=this.locationService.ElementList.filter(t=>t.required),this.locationService.dragdropListTc=t.filter(t=>t.required)}))}getElement(t){return this.transmissionService.getElement(t)}}return t.\u0275fac=function(i){return new(i||t)(n.Wb(c),n.Wb(o.a),n.Wb(a.a))},t.\u0275cmp=n.Qb({type:t,selectors:[["app-location"]],viewQuery:function(t,i){var e;1&t&&n.Sc(u,!0),2&t&&n.Cc(e=n.lc())&&(i.myInputVariable=e.first)},decls:2,vars:2,consts:[[4,"ngIf"],["class","alert danger",4,"ngIf"],["dynamicHeight","",3,"color"],["label","Download Template"],[3,"itemService","tabTitle","isAdminTab"],["label","Create Template"],["class","ui active inverted dimmer",4,"ngIf"],[1,"ui","active","inverted","dimmer"],[1,"example-h2"],["mode","buffer",2,"width","50%",3,"color","bufferValue","value"],[1,"ui","text","loader"],[1,"alert","danger"],["onclick","this.parentElement.style.display='none';",1,"closebtn"],[1,"alert-header"]],template:function(t,i){1&t&&(n.Lc(0,m,8,9,"ng-container",0),n.Lc(1,f,5,1,"div",1)),2&t&&(n.vc("ngIf",!i.error),n.Jb(1),n.vc("ngIf",i.error))},directives:[d.m,l.b,l.a,h.a,v.a],styles:[""]}),t})();var T=e("jvDc");const S=[{path:"",component:g}];let L=(()=>{class t{}return t.\u0275mod=n.Ub({type:t}),t.\u0275inj=n.Tb({factory:function(i){return new(i||t)},providers:[c],imports:[[a.i.forChild(S),T.a]]}),t})()}}]);